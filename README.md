# ruby_graduation
## サービス概要
夜勤の仮眠休憩シフト作成アプリケーション
管理者がスタッフの仮眠休憩を自動振り分けを行うことができる
設定に応じてシフト作成を行い、作成作業時間・手間を短縮する

## このサービスへの思い・作りたい理由
私は現在24時間稼働している職場で勤務をしており、夜勤中では複数のスタッフ（約8～10名）と複数の仮眠室に交代で仮眠休憩（2時間）をとっています。
現在はリーダースタッフが手書きで仮眠休憩のシフト作成を行っており、複雑な場合であるとシフト作成にかなりの手間や時間を要していました。
この作成作業をアプリケーション化することで作成時間や手間を短縮することができると考え、今回の発案に至りました。

## ユーザー層について
24時間稼働しており仮眠休憩が交代で必要な職場における、管理者の利用を想定しています。（医療機関、コールセンター、物流センターなど）

## サービスの利用イメージ
- 各勤務帯毎での仮眠休憩シフト配置に特化し、大元となる勤務表は既存することを想定
- 管理者は勤務表から当日の勤務者を選択する
- 役職・勤務時間・休憩室数・小グループ設定などを入力する
　(休憩時間を被らせたくない場合、小グループ化しその間で交代をする)
- アプリが自動で仮眠休憩を割り当て、シフト表を生成する
　(縦軸：スタッフ名、横軸：時間 として労働・仮眠時間、仮眠場所が分かるように出力)
- 管理者は必要に応じて手動で調整できる
- 完成したシフト表をPDF出力し、スタッフに共有できる
- 過去のシフト表はDBに保存され、参照可能
- MVPでは施設ごと管理者1人での利用を想定
　将来的には複数の管理者が1つの施設を共同管理できるよう拡張に対応予定


## ユーザーの獲得について
本サービスは医療機関やコールセンターなど24時間稼働している職場全般で活用可能である。まずは、現在勤務中の職場に業務改善案として本サービス・アプリケーションの導入の提案を行い、使用ユーザーの獲得を目指している。
導入が実現すれば、自分が所属する管理者で使用頂き、改善点等フィードバックを募り今度のサービス改善に繋げていく予定。

## サービスの差別化ポイント・推しポイント
- 仮眠休憩に特化している点
  一般的なシフト作成アプリケーションは月間や週間などの全体的な勤務を管理するが、本サービスは"仮眠休憩"に特化
- 詳細な設定が可能な点
  「役職ごとの条件」「勤務帯ごとの小グループ設定」「複数の休憩室対応」など現場で実際に困っている細かいルールに対応する。
  市販のシフト管理アプリではカスタマイズしづらい部分を反映できる。
- 自動化と手動調整が可能な点
  シフト生成を自動化し、手動調整も行えるようにすることで人間的な配慮も可能とする
- データ保存・参照が可能な点
  過去のシフトをDBに保存することで、過去の休憩割り当てや記録を確認するニーズも対応
- 複数の施設のシフト作成が可能な点
  一人の管理人が複数の施設のシフトを担当する、複数の管理人が一つの施設のシフト作成を担当することも可能とする

## 機能候補
### MVPリリース時に作っていたいもの
- 勤務者の登録と管理(名前、役職、権限)
- シフト作成（勤務者、勤務時間を選択）
- 条件設定(休憩室、小グループ)
- 入力条件に基づき休憩時間、配置を自動作成
- シフト表のタイムライン式表示（縦軸:スタッフ名、横軸:時間軸）
- シフト編集機能（個々の勤務時間、休憩時間、休憩室をプルダウン式で編集可能）
- DBに保存しカレンダー式で履歴を参照できる
- 施設ごとのシフトをprojectsとし、usersとprojectsの間にuser_projectsとなる中間テーブルを設定する

### シフト自動作成のロジックについて
- ユーザーが設定する条件
  - シフトメンバーと人数
  - 休憩場所と数
  - 小グループ分け
- 制約条件
  - 休憩時間は2時間固定
  - 小グループ内で休憩時間が重ならないように配置（できるだけ）
  - 同じ時間で休憩場所は被らないように配置(必須)
  - 夜勤18時~9時の間、0時～6時は優先的に休憩を割り当てる

- 自動割り当てアルゴリズム概要
  - 夜勤時間をスロット化、0~6時を優先順序の先頭に配置する
  - 優先スロットから順番に空き時間を確認、小グループと休憩場所の重複を避け割り当て

  
### 本リリースまでに作っていたいもの
- 管理者Aが作成したプロジェクトをその他管理者が参加できる招待機能
- 作成したシフトをPDF化し印刷対応可能にする
- 履歴参照画面 (カレンダー表示にし過去はPDF表示,未来は編集画面へ遷移)
- シフト編集時のタイムライン上でのドラッグ操作による直感的な編集
- 制約条件チェック（小グループ内や休憩室で重複があった際のエラーアラート）
- 当日の管理者機能（時間になると該当者を通知、チェック）


## 機能の実装方針予定
### バックエンド
- Ruby: 3.1.x
- Ruby on Rails: 7.0.x
- PostgreSQL(データベース)
- Heroku(MVP開発まで、本番運用は社内規定に準ずる)

### フロントエンド
- HTML/CSS
- Javascript
  - 将来的にシフト表のグラフのドラッグ操作編集用にInteract.jsの使用予定
  - Select2(シフト作成時のスタッフ名の検索/複数選択)
 
### gem
- devise:ログイン
- pundit:権限管理
- simple_form
- simple_calendar
- prawn/wicked_pdf:PDF出力
- ActionMailer
- SecureRandom(招待機能のToken管理)

### ER図
https://drive.google.com/file/d/10_OLWKsBMn0iNOB61sFbeq-U1oAyj97v/view?usp=sharing

### 画面遷移図
Figma：
(画面デザイン)https://www.figma.com/design/dwfXBf5STVf1RRq4me65RP/%E7%94%BB%E9%9D%A2%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3?node-id=0-1&t=3psAY48AqNjUraOt-1
(画面遷移図)https://www.figma.com/design/GdxGtiIdg5eUcomqoHoReE/%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3%E2%91%A0?node-id=0-1&t=EL8hDdhKk3jDtkwM-1

### READMEに記載した機能
- [x] ユーザー登録機能
- [x] ログイン機能
- [x] パスワード変更機能
- [x] メールアドレス変更機能
- [x] スタッフ検索機能
- [x] ページネーション


### 未ログインでも閲覧または利用できるページ
以下の項目は適切に未ログインでも閲覧または利用できる画面遷移になっているか？
- 未ログインでも利用できるページは存在しない(全機能ログイン必須)

### メールアドレス・パスワード変更確認項目
直接変更できるものではなく、一旦メールなどを介して専用のページで変更する画面遷移になっているか？
- [x] メールアドレス
- [x] パスワード

### 各画面の作り込み
画面遷移だけでなく、必要なボタンやフォームが確認できるくらい作り込めているか？
- [x] 作り込みはある程度完了している（Figmaを見て画面の作成ができる状態にある）